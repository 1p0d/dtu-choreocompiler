A: sk(A,s), A,s,B, pk(B), msg, udp.
s: sk(A,s), A,s,B, pk(B), msg, udp, pk(s), inv(pk(s)).
B: A,s,B, pk(B), inv(pk(B)), pk(s), msg, udp.

(A: new M, K. A -> s: l
    ([crypt(pk(B),pair(msg,M))]sk(A,s).
    s -> B: l1 sign(inv(pk(s)),crypt(pk(B),pair(msg,M))))
 +  ([crypt(pk(B),pair(udp,K))]sk(A,s).
    s -> B: l1 sign(inv(pk(s)),crypt(pk(B),pair(udp,K)))))
